# Script: debra.ps1

function Show-WelcomeMessage {
    Write-Host "`nAmbiente massinha para Windows" -ForegroundColor Green
}

function Show-RDPPort {
    $rdpInfo = Get-ItemProperty `
        -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' `
        -Name "PortNumber"

    Write-Host "`nA porta RDP configurada é: $($rdpInfo.PortNumber)" -ForegroundColor Yellow
}

function Show-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cpu = Get-CimInstance Win32_Processor

    Write-Host "`nInformações do Sistema:" -ForegroundColor Yellow
    Write-Host "Hostname: $env:COMPUTERNAME"
    Write-Host "Versão do Kernel: $($os.Version)"
    Write-Host "Arquitetura: $($os.OSArchitecture)"
    Write-Host "Memória Total (GB): {0:N2}" -f ($os.TotalVisibleMemorySize / 1GB)
    Write-Host "Processador: $($cpu.Name)"
}

function Show-Menu {
    Write-Host "`nMenu de Opções:" -ForegroundColor Cyan
    Write-Host "1 - Mostrar porta RDP"
    Write-Host "2 - Informações do sistema"
    Write-Host "0 - Sair"
}

function Start-Debra {
    Show-WelcomeMessage

    while ($true) {
        Show-Menu
        $option = Read-Host "Escolha uma opção"

        switch ($option) {
            "1" { Show-RDPPort }
            "2" { Show-SystemInfo }
            "0" {
                Write-Host "Saindo do ambiente..." -ForegroundColor Red
                break
            }
            default {
                Write-Host "Opção inválida!" -ForegroundColor Red
            }
        }
    }
}
